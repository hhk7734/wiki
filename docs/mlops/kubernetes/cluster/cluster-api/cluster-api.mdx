---
id: cluster-api
title: Cluster API Operator 설치 가이드
sidebar_label: 설치 가이드
description: Cluster API Operator 설치 가이드
keywords:
  - cluster-api
  - operator
  - helm
---

## 설치

:::info[Reference]

- [Cluster API Operator / Installation / Using Helm Charts](https://cluster-api-operator.sigs.k8s.io/02_installation/04_helm-chart-installation)

:::

:::warning

[cert-manager](/docs/mlops/mlops/auth/cert-manager/cert-manager.mdx)가 설치되어있어야 합니다.

:::

```shell
helm repo add capi-operator https://kubernetes-sigs.github.io/cluster-api-operator
```

```shell
helm repo update capi-operator \
&& helm search repo capi-operator/cluster-api-operator -l | head -n 10
```

```shell
helm pull capi-operator/cluster-api-operator --version 0.22.0
```

```shell
helm show values capi-operator/cluster-api-operator --version 0.22.0 > cluster-api-operator-0.22.0.yaml
```

```yaml title="cluster-api-operator-values.yaml"
core:
  cluster-api:
    version: v1.10.4
    namespace: capi-system
    createNamespace: true
```

:::info

[Cluster API Docs / Reference / Provider List](https://cluster-api.sigs.k8s.io/reference/providers.html)

:::

- `core`
  - `cluster-api`
    - `version: <version>`
      - [Cluster API GitHub / Releases](https://github.com/kubernetes-sigs/cluster-api/releases)

```shell
helm template cluster-api-operator capi-operator/cluster-api-operator \
    --version 0.22.0 \
    -n capi-operator-system \
    -f cluster-api-operator-values.yaml \
    > cluster-api-operator.yaml
```

```shell
helm upgrade -i cluster-api-operator capi-operator/cluster-api-operator \
    --history-max 5 \
    --version 0.22.0 \
    -n capi-operator-system \
    -f cluster-api-operator-values.yaml
```

## 삭제

```shell
for crd in $(kubectl get crd -o name | grep 'cluster.x-k8s.io' |
  grep -v 'operator.cluster.x-k8s.io'); do

  kind=$(kubectl get "$crd" -o jsonpath='{.spec.names.plural}')
  group=$(kubectl get "$crd" -o jsonpath='{.spec.group}')
  kubectl delete "$kind.$group" --all --all-namespaces
done
```

```shell
for crd in $(kubectl get crd -o name | grep 'operator.cluster.x-k8s.io'); do

  kind=$(kubectl get "$crd" -o jsonpath='{.spec.names.plural}')
  group=$(kubectl get "$crd" -o jsonpath='{.spec.group}')
  kubectl delete "$kind.$group" --all --all-namespaces
done
```

```shell
helm uninstall cluster-api-operator -n capi-operator-system
```

```shell
kubectl get crd -oname | grep --color=never 'cluster.x-k8s.io' | xargs kubectl delete
```
