---
id: helm
title: Helm 명령어로 애플리케이션 배포하기
sidebar_label: Helm으로 배포하기
description: Helm 명령어로 애플리케이션 배포하기
keywords:
  - helm
  - release
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

## 설치

- [mise로 런타임 버전 관리하기](/docs/lang/etc/command-line-tools/version/mise.mdx#버전-관리)

<Tabs
    groupId="shell"
    defaultValue="zsh"
    values={[
        {label: 'zsh', value: 'zsh',},
        {label: 'bash', value: 'bash',},
    ]}
>
<TabItem value="zsh">

```shell title="$HOME/.zshrc"
source <(helm completion zsh)
```

</TabItem>

<TabItem value="bash">

```shell title="$HOME/.bashrc"
source <(helm completion bash)
```

</TabItem>

</Tabs>

## Repository

### 클라이언트에서 Repository 관리

```shell
helm repo add <repositoryName> <URL> [flags]
```

e.g., `helm repo add stable https://charts.helm.sh/stable`

```shell
helm repo list [flags]
```

```shell
helm search repo <keyword> [flags]
```

- `-l`, `--versions`: 여러 버전을 표시합니다.

```shell
helm repo update [repositoryName1 [repositoryName2 ...]] [flags]
```

### Repository 서버

e.g., https://github.com/lol-iot/helm-charts

## Chart

### Custom Chart 만들기

```shell
helm create <chartName> [flags]
```

- `Chart.yaml`: https://helm.sh/docs/topics/charts/
- https://helm.sh/ko/docs/chart_template_guide/builtin_objects/
- https://helm.sh/ko/docs/chart_template_guide/functions_and_pipelines/
- `_<name>.tpl`: https://helm.sh/ko/docs/chart_template_guide/named_templates/

```shell
<chartName>/
├── Chart.yaml
├── LICENSE            # optional
├── README.md          # optional
├── values.yaml
├── values.schema.json # optional
├── charts/
├── crds/              # optional
├── templates/
│   ├── NOTES.txt      # optional
│   ├── _helpers.tpl   # optional
│   └── ...
└──
```

### 배포될 리소스 미리보기

```shell
helm template <releaseName> <repositoryName/chartName|chartPath> [flags]
```

### Chart 패키징

```shell
helm package <chartPath> --version <version>
```

```shell
helm pull <repositoryName/chartName> --version <version>
```

```shell
helm pull <chartURL> --version <version>
```

```shell
helm pull --repo <repoURL> <chartName> --version <version>
```

### 리소스 배포

```shell
helm show values <repositoryName/chartName|chartPath> [flags]
```

```shell
helm install <releaseName> <repositoryName/chartName|chartPath> [flags]
```

:::info
`helm upgrade <releaseName> <repositoryName/chartName|chartPath> --install [flags]` 을 사용하면, 설치되어 있지 않은 경우 설치하고, 설치되어 있는 경우 업그레이드합니다.
:::

- `-f <path>`: 오버라이드 할 YAML 설정 파일
- `--set <name>=<value>`: 오버라이드 할 설정

```shell
helm status <releaseName> [flags]
```

```shell
helm test <releaseName> [flags]
```

### 배포 관리

```shell
helm list [flags]
```

- 설치된 릴리즈의 NAME, NAMESPACE, REVISION, UPDATED, STATUS, CHART, APP VERSION 표시
- `-A|--all-namespaces`

```shell
helm upgrade <releaseName> <repositoryName/chartName|chartPath> [flags]
```

- `-i|--install`: 설치가 안되어 있으면 설치합니다.

```shell
helm get values <releaseName> [flags]
```

```shell
helm get manifest <releaseName> [flags]
```

```shell
helm history <releaseName> [flags]
```

```shell
helm rollback <releaseName> <revision> [flags]
```

### 배포 삭제

```shell
helm uninstall <releaseName> [flags]
```

## Dependency 추가하기

:::info[References]

- [Helm / Commands / helm dependency](https://helm.sh/docs/helm/helm_dependency/)
- [Helm / Chart Template Guide / Subcharts and Globals](https://helm.sh/docs/chart_template_guide/subcharts_and_globals/)

:::

추가하고자 하는 차트의 정보를 `<chartPath>/Chart.yaml` 파일의 `dependencies` 항목에 추가합니다.

```yaml title="<chartPath>/Chart.yaml"
dependencies:
  - name: <name>
    version: <version>
    repository: <repository>
```

- `alias: <name>`
  - 같은 차트를 여러 번 추가하거나 values에서 `<name>` 대신 사용하고싶은 이름을 지정할 때 사용합니다.
- `repository`
  - `https://...`
  - `file://...`
  - `oci://...`
- `condition: <key>`
  - 일반적으로 `<name>.enabled` 또는 `<alias>.enabled`을 사용합니다.

추가한 차트가 application 타입인 경우 `<chartPath>/values.yaml` 파일에 `<name>` 항목을 추가하여 서브차트의 값을 설정할 수 있습니다.

```yaml title="<chartPath>/values.yaml"
global: {}

<name>: # <alias>:
  enabled: true
  # subchart values
```

```shell
helm dependency update [<chartPath>]
```

`update` 명령어는 `Chart.yaml`파일을 바탕으로 `charts/` 디렉토리를 업데이트합니다.

```shell
helm dependency list [<chartPath>]
```

```shell
helm dependency build [<chartPath>]
```

`build` 명령어는 `Chart.lock`파일을 바탕으로 `charts/` 디렉토리를 업데이트합니다.
