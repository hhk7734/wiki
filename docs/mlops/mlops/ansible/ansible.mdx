---
id: ansible
title: Ansible 기본 안내
sidebar_label: Ansible 기본 안내
description: Ansible 기본 안내
keywords:
  - Ansible
---

## 설치

```shell
python3 -m pip install ansible
```

## Control node

- [SSH 키 생성 후 Managed node에 키 추가](/docs/lang/etc/command-line-tools/ssh)

## Directory structure

- https://docs.ansible.com/ansible/2.8/user_guide/playbooks_best_practices.html#alternative-directory-layout

```shell
./
├── ansible.cfg # 설정 파일
├── inventories/
│   ├── production/
│   │   ├── hosts.yaml # production 서버용 inventory
│   │   ├── group_vars/
│   │   │   ├── <group1>.yaml # 특정 그룹에 대한 변수
│   │   │   ├── <group2>.yaml
│   │   │   └── ...
│   │   └──  host_vars/
│   │       ├── <hostname1>.yaml # 특정 호스트에 대한 변수
│   │       ├── <hostname2>.yaml
│   │       └── ...
│   └── dev/
│       ├── hosts.yaml
│       ├── group_vars/
│       │   ├── <group1>.yaml
│       │   ├── <group2>.yaml
│       │   └── ...
│       └──  host_vars/
│           ├── <hostname1>.yaml
│           ├── <hostname2>.yaml
│           └── ...
├── library/ # 커스텀 모듈
├── module_utils/ # 커스텀 모듈 유틸
├── filter_plugins/ # 커스텀 필터 플러그인
├── <purpose1>.yaml # playbook
├── <purpose2>.yaml
├── ...
└── roles/
    └── ...
```

## Inventory

- [Inventory](/docs/mlops/mlops/ansible/inventory)

## Playbook

```yaml title="example.yaml"
- hosts: all
  gather_facts: false
  tasks:
    - name: "example"
      command: "echo hello"
```

## Playbook 실행

```shell
ansible-playbook <playbook>
```

- `-i|--inventory <dir|yaml>`
- 연결 옵션
  - `-u|--user <user>`: 원격 접속 시 사용될 사용자를 설정합니다.
    - `None`이 기본값이고, 이 경우 명령을 실행시키는 쉘의 사용자가 사용됩니다.
  - `-k|--ask-pass`: 원격 접속 시 사용될 비밀번호를 물어보도록 설정합니다.
- 작업 권한 옵션
  - `-b|--become`: `<becomeMethod>`로 작업을 실행시키도록 설정합니다.
  - `--become-user <becomeUser>`: become 사용자를 변경합니다.
    - `root`가 기본값입니다.
  - `-K|--ask-become-pass`: become 사용자의 비밀번호를 물어보도록 설정합니다.
  - `--become-method <becomeMethod>`: 권한 상승 방법을 설정합니다.
    - `sudo`가 기본값입니다.
    - `ansible-doc -t become -l` 명령어로 가능한 값들을 확인할 수 있습니다.
